# 概率编程
## 背景与发展历程
生活中存在大量概率问题需要分析，而通常需要构思概率模型，以某种方式来规划概率空间，并为其指定数值化概率。传统的概率模型用自然语言文本和半正式的数学标记法的组合书写，并进一步从模型的数学处理中得出想要的答案。这些工作不仅对分析人员的数学基础要求很高，同时还十分费时费力、容易出错，因而使得概率理论的适用性受到了严重限制。
		解决该问题的关键进步是定义概率模型所用的形式化语言，例如：贝叶斯网络和马尔科夫网络。形式化语言具有定义正确表达式的精确语法，以及定义每种正确表达式含义的精确语义（即每个表达式表示哪种概率模型）。这些形式化表达方法对于概率理论进入更广阔的应用领域非常重要，因为一旦面向概率模型的形式化语言可以被机器理解，则进一步开发一种基于该形式化语言的算法范式就成为可能。很可惜，贝叶斯网络和马尔可夫网络的表达能力都还不足以胜任。

  1997 年，Avi Pfeffer 和导师 Daphne Koller 等作者发表了一篇关于概率编程语言（PPL）的原创论文，提供了将概率理论与编程语言联系起来的关键思路。该思路通过引入随机元素使程序能够表达概率模型，并将程序的意义定义为每个可能执行路径的概率。该思路以高效方式结合了两个重要分支，对近二十年概率推理的蓬勃发展奠定了基础。

![https://pic1.zhimg.com/80/2f3aea91033a323615413ac601c376a4_1440w.jpg?source=1940ef5c](https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210425190948_e7.webp)

而最近 10 年来，随着神经网络技术突飞猛进的发展以及概率编程技术受到广泛关注，机器学习从原本不可调和的两个阵营（统计和神经网络，统计阵营催生了概率编程，而神经网络阵营产生了深度学习之类的变革性运动）逐步聚集在一起，大量科学家将深度学习和贝叶斯建模结合到单个程序中，其最终表达是**深度概率编程语言(Deep PPL)**。从概念上讲，深度PPL可以表达具有概率权重和偏差的贝叶斯神经网络。 实际上，深度PPL已实现为与流行的深度学习框架无缝集成的新概率语言和库。概率推理已在Uber，Facebook或Microsoft等技术巨头中得到广泛采用，开发了诸如Edward、Pyro、Pymc3、JAGS、STAN等开源系统，并成为机器学习中最活跃的发展领域之一。

<img src="https://gitee.com/XiShanSnow/imagebed/raw/master/images/articles/spatialPresent_20210425185703_18.webp" alt="https://img-service.csdnimg.cn/img_convert/a47b63efe76736f4dd83ea29910e58ec.png" style="zoom: 33%;" />



## 什么是概率编程？

  从概念上讲，概率编程语言(PPL)是面向特定领域的专用语言，描述了概率模型以及在这些模型中进行推理的机制。 其魔力在于将概率方法的推理能力与编程语言的表示能力相结合。

概率编程语言的基础是贝叶斯原理。在PPL程序中，通过人为给予先验分布对模型参数做出编码假设；在执行期间，PPL程序启动统计推断过程，根据观察到的数据自动计算模型参数的后验分布， 即使用观察到的数据来调整先验分布以给出更精确的模式。 因为贝叶斯方法认为所有模型的参数均是随机变量，无法给出一个确定的值，因此PPL程序的输出是概率分布，它使程序员可以可视化地了解和操控与结果相关的不确定性。

​      

## 常见概率编程语言
（1）PYMC3

概率编程允许在用户自定义的概率模型上进行自动贝叶斯推断。新的MCMC(Markoc chain Monte Carlo)采样方法允许在复杂模型上进行推断。这类MCMC采样方法被称为HMC(Hamliltinian Monte Carlo)，但是其推断需要的梯度信息有时候是不获得的。PyMC3是一个用Python编写的开源的概率编程框架，使用Theano通过变分推理进行梯度计算，并使用了C实现加速运算。不同于其他概率编程语言，PyMC3允许使用Python代码来定义模型。这种没有作用域限制的语言极大的方便了模型定义和直接交互。这篇文章介绍了这个软件包。

（2）

（3）

（4）


